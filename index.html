<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>LPAPIM - La Poste API Management</title>
  <meta name="description" content="Présentation d'introduction sur la plateforme Open API du Groupe La Poste">
  <meta name="author" content="Olivier Penhoat">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="css/reveal.min.css">
  <link rel="stylesheet" href="css/theme/laposte.css" id="theme">
  <!-- For syntax highlighting -->
  <link rel="stylesheet" href="lib/css/zenburn.css">
  <!-- Custom styles -->
  <link rel="stylesheet" href="assets/slides.css">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
    (function () {
      var link;
      if (window.location.search.match(/print-pdf/gi)) {
        link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName('head')[0].appendChild(link);
      }
    })();
  </script>
  <!--[if lt IE 9]>
  <script src="lib/js/html5shiv.js"></script>
  <![endif]-->
  <script>
    var appKey, adminApiBaseUrl, apiBaseUrl, apiDemoBaseElt;
    appKey = 'GRH+CMrfqkIJMboiggvD72GuNqxL8RMcEVC8ud2IvzMyFXiexz51LiSrCrG2EhVF';
    //adminApiBaseUrl = 'https://adminapi.laposte.fr';
    //apiBaseUrl = 'https://api.laposte.fr';
    adminApiBaseUrl = 'http://admin.test.lpapim.laposte.io';
    apiBaseUrl = 'http://api.test.lpapim.laposte.io';

    function refreshHighlightBlocks() {
      $(apiDemoBaseElt + ' pre code').each(function (i, block) {
        hljs.highlightBlock(block);
      });
    }

    function showJsonResult(result) {
      $(apiDemoBaseElt + ' .resultBody').text(JSON.stringify(result, null, 2));
      refreshHighlightBlocks();
    }

    function toggleSourceCode() {
      $('pre').toggle();
      return false;
    }

    $.ajaxSetup({
      contentType: 'application/json; charset=utf-8',
      dataType: 'json',
      beforeSend: function (xhr) {
        $('body').addClass('loading');
        xhr.setRequestHeader('X-LP-APIM-KEY', appKey);
      },
      complete: function () {
        $('body').removeClass('loading');
      },
      success: function (result) {
        showJsonResult(result);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        var content = JSON.parse(jqXHR.responseText);
        showJsonResult(content);
      }
    });
  </script>
</head>
<body>
<div class="reveal">
  <div class="slides">

    <section class="first">
      <div>
        <div class="title">
          <h1>La Poste</h1>
          <h2>API Management</h2>
          <h3>Intro</h3>
        </div>
        <div class="author">
          <p>Olivier Penhoat / David Carelli / Philippe Antoine</p>
          <p>
            Branche Numérique / La Poste
          </p>
          <div style="margin-top: 20px">
            <p>
              <a href="mailto:developer@laposte.io">developer@laposte.io</a>
            </p>
            <p>
              <a href="https://twitter.com/LaPosteAPI" class="twitter-follow-button" data-show-count="false"
                 data-lang="fr" data-show-screen-name="false" data-size="large" data-dnt="true">Suivre @LaPosteAPI</a>
              <script>!function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
                if (!d.getElementById(id)) {
                  js = d.createElement(s);
                  js.id = id;
                  js.src = p + '://platform.twitter.com/widgets.js';
                  fjs.parentNode.insertBefore(js, fjs);
                }
              }(document, 'script', 'twitter-wjs');</script>
            </p>
          </div>
        </div>
      </div>
      <div class="poweredby">
        <p>
          Propulsé par <a href="http://lab.hakim.se/reveal-js">Reveal JS</a>
        </p>
        <p>
          <a href="?print-pdf/#">Version imprimable</a>
        </p>
      </div>
      <aside class="notes"><pre><small>
        Adresses de cette présentation :
        http://lpapimslideshow.laposte.io
        Raccourcis :
        f=fullscreen, s=notes, o=overview, ./b=black screen
      </small></pre>
      </aside>
    </section>

    <section>

      <section>
        <h2>Présentation Personnas</h2>
        <div style="margin-top: 80px">
          <h3 style="float: left; margin-left: 90px">Elsa</h3>
          <h3 style="float: right; margin-right: 50px">Caroline</h3>
          <h5 style="float: left; margin-left: 170px">GETSHIRT Startup</h5>
        </div>
        <img src="assets/img/elsa-et-caroline.png" style="margin-top: 0">
        <h5 style="margin-top: 50px">Et si vous étiez à la place de Caroline ?</h5>
      </section>
      <section>
        <h3>API La Poste = compliqué ?</h3>
        <img src="assets/img/twitter.png">
        <h4>@LaPosteAPI</h4>
      </section>
      <section>
        <h3>Panorama des services</h3>
        <h5>exposés via la plateforme</h5>
        <img src="assets/img/panorama-services.png">
      </section>
      <section>
        <h3>Elsa veut acheter un t-shirt à Caroline</h3>
        <div style="margin-top: 0">
          <img src="assets/img/lp-apim-big-picture.png" style="width: 60%">
        </div>
      </section>

      <section>
        <img src="assets/img/adresse.png" style="float: left; width: 100px">
        <div>
          <h3>Normalisation d'adresse</h3>
          <p>
            Elsa saisit son adresse sans erreur sur le site de Caroline
          </p>
        </div>
        <form id="adresseForm" style="margin-top: 80px; clear: both">
          <fieldset>
            <label>
              Adresse :
              <input list="adresses" id="adresse" type="text" placeholder="21 Quai Louis Blériot, 75016 Paris" size="70"
                     title="Saisissez un numéro de colis ou de courrier" data-list="">
              <datalist id="adresses">
                <option id="adresseOriginale" value="">
                <option id="adresseProposee" value="">
              </datalist>
            </label>
            <button class="validButton">ok</button>
          </fieldset>
          <pre><code class="resultBody" title="Résultat de la requête" data-trim>
          </code></pre>
          <pre class="sourceCode" style="display: none"><code>
$.ajax({
  url: 'https://api.laposte.fr/mascadia/v1/rechercher?chaineRecherche=' + adresse,
  success: function (suggestionAdresse) {
    // utiliser suggestionAdresse
  }
});
          </code></pre>
          <div style="text-align: right">
            <a href="#" onclick="return toggleSourceCode()">
              <small>source</small>
            </a>
          </div>
        </form>
        <script>
          $('#adresseForm .validButton').click(function () {
            var adresse = $('#adresse').val();
            apiDemoBaseElt = '#adresseForm';
            $.ajax({
              url: apiBaseUrl + '/mascadia/v1/rechercher?chaineRecherche=' + adresse,
              success: function (result) {
                result.libelleHighlight = result.libelleHighlight.replace(/\<[\/]?em\>/g, '');
                console.log('result :', result);
                showJsonResult(result);
                $('#adresse').val('');
                $('#adresseOriginale').val(adresse);
                $('#adresseProposee').val(result.libelleHighlight);
              }
            });
            return false;
          });
        </script>
      </section>

      <section>
        <img src="assets/img/suivi.png" style="float: left; width: 100px">
        <div>
          <h3>Suivi de colis</h3>
          <p>
            Elsa peut suivre son colis sur le site de Caroline
          </p>
        </div>
        <form id="suiviForm" style="margin-top: 80px">
          <fieldset>
            <label>
              N° de colis :
              <input id="suiviCode" type="text" placeholder="1234567890123"
                     title="Saisissez un numéro de colis ou de courrier">
            </label>
            <button class="validButton">ok</button>
          </fieldset>
          <h5 id="suiviStatus"></h5>
          <pre><code class="resultBody" title="Résultat de la requête" data-trim>
          </code></pre>
          <pre class="sourceCode" style="display: none"><code>
$.ajax({
  url: 'https://api.laposte.fr/suivi/v1/?code=' + noColis,
  success: function (statut) {
    // utiliser statut
  }
});
          </code></pre>
          <div style="text-align: right">
            <a href="#" onclick="return toggleSourceCode()">
              <small>source</small>
            </a>
          </div>
        </form>
        <script>
          $('#suiviForm .validButton').click(function () {
            var code = $('#suiviCode').val();
            apiDemoBaseElt = '#suiviForm';
            $.ajax({
              url: apiBaseUrl + '/suivi/v1?code=' + code,
              success: function (result) {
                $('#suiviStatus').text(result.message);
                showJsonResult(result);
              }
            });
            return false;
          });
        </script>
      </section>

      <section>
        <img src="assets/img/datanova.png" style="float: left; width: 100px">
        <div>
          <h3>Datanova</h3>
          <p>
            Elsa cherche un bureau de poste
          </p>
        </div>
        <form id="bureauForm">
          <fieldset>
            <label>
              Où :
              <input id="bureauSearch" type="text" placeholder="Toulouse"
                     title="Saisissez une adresse/zone où trouver un bureau de poste">
            </label>
            <button class="validButton">ok</button>
          </fieldset>
          <a id="gmapLink" href="" style="display:none">Google map</a>
          <pre><code class="resultBody" title="Résultat de la requête" data-trim>
          </code></pre>
          <pre class="sourceCode" style="display: none"><code>
$.ajax({
  url: 'https://api.laposte.fr/datanova/v1/search?q=' + q,
  success: function (bureaux) {
    // utiliser bureaux
  }
});
          </code></pre>
          <div style="text-align: right">
            <a href="#" onclick="return toggleSourceCode()">
              <small>source</small>
            </a>
          </div>
        </form>
        <script>
          $('#bureauForm .validButton').click(function () {
            var q = $('#bureauSearch').val();
            apiDemoBaseElt = '#bureauForm';
            $.ajax({
              url: apiBaseUrl + '/datanova/v1/search?q=' + q,
              success: function (result) {
                $('#gmapLink').attr('href', result[0].map).show();
                showJsonResult(result);
              }
            });
            return false;
          });
        </script>
      </section>

      <section>
        <img src="assets/img/tarifenvoi.png" style="float: left; width: 100px">
        <div>
          <h3>Tarif envoi</h3>
          <p>
            Elsa veut savoir combien coûte le renvoi de colis
          </p>
        </div>
        <form id="tarifEnvoiForm" style="margin-top: 80px">
          <fieldset>
            <label>
              Poids :
              <input id="tarifEnvoiPoids" type="text" placeholder="800"
                     title="Saisissez le poids du colis en grammes"> gr
            </label>
            <button class="validButton">ok</button>
          </fieldset>
          <h5 id="tarifEnvoiStatus"></h5>
            <pre><code class="resultBody" title="Résultat de la requête" data-trim>
            </code></pre>
            <pre class="sourceCode" style="display: none"><code>
$.ajax({
  url: 'https://api.laposte.fr/tarifenvoi/v1/?type=colis&poids=' + grammes,
  success: function (tarifs) {
    // utiliser tarifs
  }
});
            </code></pre>
          <div style="text-align: right">
            <a href="#" onclick="return toggleSourceCode()">
              <small>source</small>
            </a>
          </div>
        </form>
        <script>
          $('#tarifEnvoiForm .validButton').click(function () {
            var poids = $('#tarifEnvoiPoids').val();
            apiDemoBaseElt = '#tarifEnvoiForm';
            $.ajax({
              url: apiBaseUrl + '/tarifenvoi/v1?type=colis&poids=' + poids,
              success: function (result) {
                $('#tarifEnvoiStatus').text(result[0].price + result[0].currency);
                showJsonResult(result);
              }
            });
            return false;
          });
        </script>
      </section>

      <section>
        <img src="assets/img/caroline.png" style="float: left; width: 150px">
        <div>
          <h3>Caroline gère ses APIs</h3>
          <p>sur <a href="https://developer.laposte.fr/">developer.laposte.fr</a></p>
        </div>
        <img src="assets/img/developer-laposte-fr.png" style="width: 70%">
      </section>

    </section>

    <section>

      <section>
        <h3>Administration</h3>
      </section>

      <section>
        <h3>Mon compte</h3>
        <h5>via #plateforme</h5>
        <form id="myAccountForm">
          <fieldset>
            <label>
              pseudo :
              <input id="username" type="text" size="20" title="Saisissez votre pseudo ou votre adresse email">
            </label>
            <label>
              secret :
              <input id="password" type="password" size="20" title="Saisissez votre mot de passe">
            </label>
            <button class="validButton">ok</button>
          </fieldset>
      <pre><code class="resultBody" title="Résultat de la requête" data-trim>
      </code></pre>
        </form>
        <script>
          $('#myAccountForm .validButton').click(function () {
            var username = $('#username').val()
                , password = $('#password').val();
            apiDemoBaseElt = '#myAccountForm';
            $.ajax({
              method: 'post',
              url: adminApiBaseUrl + '/login',
              data: JSON.stringify({
                username: username,
                password: password
              })
            });
            return false;
          });
        </script>
      </section>

    </section>

  </div>
</div>
<div class="modal"></div>
<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>
<script>
  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    slideNumber: true,
    history: true,
    center: true,
    previewLinks: true,
    transitionSpeed: 'fast',
    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
    // Parallax scrolling
    // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
    // parallaxBackgroundSize: '2100px 900px',
    // Optional libraries used to extend on reveal.js
    dependencies: [
      {
        src: 'lib/js/classList.js', condition: function () {
        return !document.body.classList;
      }
      },
      {
        src: 'plugin/markdown/marked.js', condition: function () {
        return !!document.querySelector('[data-markdown]');
      }
      },
      {
        src: 'plugin/markdown/markdown.js', condition: function () {
        return !!document.querySelector('[data-markdown]');
      }
      },
      {
        src: 'plugin/highlight/highlight.js', async: true, callback: function () {
        hljs.initHighlightingOnLoad();
      }
      },
      {
        src: 'plugin/zoom-js/zoom.js', async: true, condition: function () {
        return !!document.body.classList;
      }
      },
      {
        src: 'plugin/notes/notes.js', async: true, condition: function () {
        return !!document.body.classList;
      }
      }
    ]
  });
</script>
</body>
</html>
